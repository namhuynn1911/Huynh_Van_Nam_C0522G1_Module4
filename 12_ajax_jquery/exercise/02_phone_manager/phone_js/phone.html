<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
          integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">


    <script src="jquery-3.6.1.min.js"></script>

</head>
<body>


<h1>Phone List</h1>
<table class="table table-striped" id="showPhone">
    <thead>
    <tr>
        <th>ID</th>
        <th>Producer</th>
        <th>Model</th>
        <th>DPrice</th>
    </tr>
    </thead>
    <tbody id="tbodyList">
    <tr>
        <td>Loading.....</td>
    </tr>
    </tbody>
</table>
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#modelId">
    Create
</button>

<!-- Modal -->
<div class="modal fade" id="modelId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div>
                        <label>Producer</label>
                        <input type="text" id="textProducer">
                    </div>
                    <div>
                        <label>Model</label>
                        <input type="text" id="textModel">
                    </div>
                    <div>
                        <label>Price</label>
                        <input type="number" id="textPrice">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="btnCreate">Create</button>
            </div>
        </div>
    </div>
</div>

<!--<div>-->
<!--    <input type="hidden" id="id" value="">-->
<!--   <label>Producer:</label>-->
<!--    <input type="text" id="producerEdit" placeholder="producer" value="">-->
<!--    <br>-->
<!--    <label>Model:</label>-->
<!--    <input type="text" id="modelEdit" placeholder="model" value="">-->
<!--    <br>-->
<!--    <label>Price:</label>-->
<!--    <td><input type="text" id="priceEdit" placeholder="price" value=""></td>-->
<!--    <br>-->
<!--    <button onclick="editPhone()">Edit</button>-->
<!--</div>-->

<script src="js/bootstrap.js"></script>
<script>
    $(document).ready(function () {
        function init() {
            setTimeout(function () {
                $("#tbodyList").empty();
                $.ajax({
                    url: "http://localhost:8080/phone/list",
                    type: "GET",
                    dataType: "json",
                    success: function (data) {
                        // console.log(data);
                        let tr = [];
                        for (let i = 0; i < data.length; i++) {
                            tr.push("<tr>");
                            tr.push("<td>" + data[i].id + "</td>");
                            tr.push("<td>" + data[i].producer + "</td>");
                            tr.push("<td>" + data[i].model + "</td>");
                            tr.push("<td>" + data[i].price + "</td>");
                            tr.push("</tr>");
                        }
                        $("#showPhone").append(tr.join(""));
                    }

                })
            }, 2000)
        }

        $("#btnCreate").click(function () {
            let producer = $('#textProducer').val();
            let model = $('#textModel').val();
            let price = $('#textPrice').val();

            $.ajax({
                url: "http://localhost:8080/phone/save",
                type: "POST",
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify({'producer': producer, 'model': model, 'price': price}),
                success: function () {
                    $('#modelId').modal('hide');
                    $("#tbodyList").empty();
                    $("#tbodyList").append("loading....")
                    init();
                }
            })
        })
        init();
    })

    // function findById(id) {
    //     $.ajax({
    //         url: "http://localhost:8080/phone/findById/" + id,
    //         type: "GET",
    //         dataType: "json",
    //         success: function (data) {
    //             document.getElementById("id").value = (data.id);
    //             document.getElementById("producerEdit").value = (data.producer);
    //             document.getElementById("modelEdit").value = (data.model);
    //             document.getElementById("priceEdit").value = (data.price);
    //         }
    //     })
    // }
    //
    // function editPhone() {
    //     //lay du lieu
    //     let id = $("#id").val();
    //     let producer = $('#producerEdit').val();
    //     let model = $('#modelEdit').val();
    //     let price = $('#priceEdit').val();
    //     let newSmartphone = {
    //         id: id,
    //         producer: producer,
    //         model: model,
    //         price: price
    //     }
    //
    //     $(".table tbody").empty();
    //     $.ajax({
    //         headers: {
    //             'Accept': 'application/json',
    //             'Content-Type': 'application/json'
    //         },
    //         type: "PUT",
    //         data: JSON.stringify(newSmartphone),
    //         //tÃªn API
    //         url: "http://localhost:8080/phone/update/" + id,
    //         success: function () {
    //             $.ajax({
    //                 url: "http://localhost:8080/phone/list",
    //                 type: "GET",
    //                 dataType: "json",
    //                 success: function (data) {
    //                     let str = [];
    //                     for (let i = 0; i < data.length; i++) {
    //                         str.push("<tr>")
    //                         str.push("<td>" + data[i].id + "</td>")
    //                         str.push("<td>" + data[i].model + "</td>")
    //                         str.push("<td>" + data[i].price + "</td>")
    //                         str.push("<td>" + data[i].producer + "</td>")
    //                         str.push(`<td><button onclick="findById(` + data[i].id + `)">Edit</button></td>`)
    //                         str.push("</tr>")
    //                     }
    //                     $("table").append((str.join("")));
    //                 }
    //             })
    //         }
    //
    //     })
    //
    // }
</script>
<!--&lt;!&ndash;<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"&ndash;&gt;-->
<!--        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"-->
<!--        crossorigin="anonymous"></script>-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
        crossorigin="anonymous"></script>
</body>
</html>